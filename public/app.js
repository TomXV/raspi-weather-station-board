var Y={ui:{ja:{boardTitle:"‚õÖ Ê∞óË±°ÊÉÖÂ†±„Éú„Éº„Éâ",warningTitle:"‚ö† Ë≠¶Â†±„ÉªÊ≥®ÊÑèÂ†±Ôºà‰∏ªË¶ÅÈÉΩÂ∏Ç + Èï∑ÈáéÁúå / ÁîüÊñáÔºâ",piTitle:"üñ• Raspberry Pi „Çπ„ÉÜ„Éº„Çø„Çπ",majorLabel:"‚ñ∂ ‰∏ªË¶ÅÈÉΩÂ∏Ç",naganoLabel:"‚ñ∂ Èï∑ÈáéÁúå",updated:"ÊúÄÁµÇÊõ¥Êñ∞",updating:"Êõ¥Êñ∞‰∏≠...",precip:"ÈôçÊ∞¥Èáè",wind:"È¢®ÈÄü",humidity:"ÊπøÂ∫¶",failed:"ÂèñÂæóÂ§±Êïó",page:"„Éö„Éº„Ç∏",nextUpdate:"Ê¨°ÂõûÊõ¥Êñ∞„Åæ„Åß",am:"ÂçàÂâç",pm:"ÂçàÂæå",hourUnit:"ÊôÇ",weekdays:["Êó•Êõú","ÊúàÊõú","ÁÅ´Êõú","Ê∞¥Êõú","Êú®Êõú","ÈáëÊõú","ÂúüÊõú"],piTemp:"Ê∏©Â∫¶",piLoad:"Ë≤†Ëç∑",piMem:"„É°„É¢„É™",piDisk:"„Éá„Ç£„Çπ„ÇØ",piUptime:"Á®ºÂÉç",piIp:"IP",warningNoHeadline:"ÁèæÂú®„ÄÅÁõÆÁ´ã„Å§Ë≠¶Â†±Ë¶ãÂá∫„Åó„Å™„Åó",warningFetchFailed:"ÂèñÂæóÂ§±Êïó",warningAllFailed:"Ë≠¶Â†±„ÉªÊ≥®ÊÑèÂ†±ÊÉÖÂ†±„ÅÆÂèñÂæó„Å´Â§±Êïó",noInfo:"ÊÉÖÂ†±„Å™„Åó"},en:{boardTitle:"‚õÖ Weather Board",warningTitle:"‚ö† Warning / Advisory (Major Cities + Nagano / Raw Text)",piTitle:"üñ• Raspberry Pi Status",majorLabel:"‚ñ∂ Major Cities",naganoLabel:"‚ñ∂ Nagano",updated:"Updated",updating:"Updating...",precip:"Rain",wind:"Wind",humidity:"Humidity",failed:"Fetch Failed",page:"Page",nextUpdate:"Next update in",am:"AM",pm:"PM",hourUnit:"",weekdays:["SUN","MON","TUE","WED","THU","FRI","SAT"],piTemp:"Temp",piLoad:"Load",piMem:"Memory",piDisk:"Disk",piUptime:"Uptime",piIp:"IP",warningNoHeadline:"No notable warnings",warningFetchFailed:"Fetch failed",warningAllFailed:"Failed to fetch warning info",noInfo:"No data"},zh:{boardTitle:"‚õÖ Ê∞îË±°‰ø°ÊÅØÁúãÊùø",warningTitle:"‚ö† Ë≠¶Êä•/Ê≥®ÊÑèÊä•Ôºà‰∏ªË¶ÅÂüéÂ∏Ç + ÈïøÈáé / ÂéüÊñáÔºâ",piTitle:"üñ• Raspberry Pi Áä∂ÊÄÅ",majorLabel:"‚ñ∂ ‰∏ªË¶ÅÂüéÂ∏Ç",naganoLabel:"‚ñ∂ ÈïøÈáé",updated:"Êõ¥Êñ∞",updating:"Êõ¥Êñ∞‰∏≠...",precip:"ÈôçÊ∞¥",wind:"È£éÈÄü",humidity:"ÊπøÂ∫¶",failed:"Ëé∑ÂèñÂ§±Ë¥•",page:"È°µ",nextUpdate:"Ë∑ùÁ¶ª‰∏ãÊ¨°Êõ¥Êñ∞",am:"‰∏äÂçà",pm:"‰∏ãÂçà",hourUnit:"ÁÇπ",weekdays:["Âë®Êó•","Âë®‰∏Ä","Âë®‰∫å","Âë®‰∏â","Âë®Âõõ","Âë®‰∫î","Âë®ÂÖ≠"],piTemp:"Ê∏©Â∫¶",piLoad:"Ë¥üËΩΩ",piMem:"ÂÜÖÂ≠ò",piDisk:"Á£ÅÁõò",piUptime:"ËøêË°åÊó∂Èïø",piIp:"IP",warningNoHeadline:"ÊöÇÊó†ÊòéÊòæÈ¢ÑË≠¶‰ø°ÊÅØ",warningFetchFailed:"Ëé∑ÂèñÂ§±Ë¥•",warningAllFailed:"Ëé∑ÂèñÈ¢ÑË≠¶‰ø°ÊÅØÂ§±Ë¥•",noInfo:"Êó†‰ø°ÊÅØ"},ko:{boardTitle:"‚õÖ Í∏∞ÏÉÅ Ï†ïÎ≥¥ Î≥¥Îìú",warningTitle:"‚ö† Í≤ΩÎ≥¥/Ï£ºÏùòÎ≥¥ (Ï£ºÏöî ÎèÑÏãú + ÎÇòÍ∞ÄÎÖ∏ / ÏõêÎ¨∏)",piTitle:"üñ• Raspberry Pi ÏÉÅÌÉú",majorLabel:"‚ñ∂ Ï£ºÏöî ÎèÑÏãú",naganoLabel:"‚ñ∂ ÎÇòÍ∞ÄÎÖ∏",updated:"Í∞±Ïã†",updating:"Í∞±Ïã† Ï§ë...",precip:"Í∞ïÏàò",wind:"ÌíçÏÜç",humidity:"ÏäµÎèÑ",failed:"Í∞ÄÏ†∏Ïò§Í∏∞ Ïã§Ìå®",page:"ÌéòÏù¥ÏßÄ",nextUpdate:"Îã§Ïùå ÏóÖÎç∞Ïù¥Ìä∏ÍπåÏßÄ",am:"Ïò§Ï†Ñ",pm:"Ïò§ÌõÑ",hourUnit:"Ïãú",weekdays:["Ïùº","Ïõî","Ìôî","Ïàò","Î™©","Í∏à","ÌÜ†"],piTemp:"Ïò®ÎèÑ",piLoad:"Î∂ÄÌïò",piMem:"Î©îÎ™®Î¶¨",piDisk:"ÎîîÏä§ÌÅ¨",piUptime:"Í∞ÄÎèôÏãúÍ∞Ñ",piIp:"IP",warningNoHeadline:"ÌòÑÏû¨ Ï£ºÎ™©Ìï† Í≤ΩÎ≥¥ ÏóÜÏùå",warningFetchFailed:"Í∞ÄÏ†∏Ïò§Í∏∞ Ïã§Ìå®",warningAllFailed:"Í≤ΩÎ≥¥ Ï†ïÎ≥¥ Í∞ÄÏ†∏Ïò§Í∏∞ Ïã§Ìå®",noInfo:"Ï†ïÎ≥¥ ÏóÜÏùå"}},cities:[{id:"sapporo",lat:43.0618,lon:141.3545,name_ja:"Êú≠Âπå",name_en:"Sapporo",name_zh:"Êú≠Âπå",name_ko:"ÏÇøÌè¨Î°ú",region_ja:"ÂåóÊµ∑ÈÅì",region_en:"Hokkaido",region_zh:"ÂåóÊµ∑ÈÅì",region_ko:"ÌôãÏπ¥Ïù¥ÎèÑ"},{id:"sendai",lat:38.2688,lon:140.8721,name_ja:"‰ªôÂè∞",name_en:"Sendai",name_zh:"‰ªôÂè∞",name_ko:"ÏÑºÎã§Ïù¥",region_ja:"ÂÆÆÂüéÁúå",region_en:"Miyagi",region_zh:"ÂÆ´ÂüéÂéø",region_ko:"ÎØ∏ÏïºÍ∏∞ÌòÑ"},{id:"tokyo",lat:35.6762,lon:139.6503,name_ja:"Êù±‰∫¨",name_en:"Tokyo",name_zh:"‰∏ú‰∫¨",name_ko:"ÎèÑÏøÑ",region_ja:"Êù±‰∫¨ÈÉΩ",region_en:"Tokyo",region_zh:"‰∏ú‰∫¨ÈÉΩ",region_ko:"ÎèÑÏøÑÎèÑ"},{id:"nagoya",lat:35.1815,lon:136.9066,name_ja:"ÂêçÂè§Â±ã",name_en:"Nagoya",name_zh:"ÂêçÂè§Â±ã",name_ko:"ÎÇòÍ≥†Ïïº",region_ja:"ÊÑõÁü•Áúå",region_en:"Aichi",region_zh:"Áà±Áü•Âéø",region_ko:"ÏïÑÏù¥ÏπòÌòÑ"},{id:"osaka",lat:34.6937,lon:135.5023,name_ja:"Â§ßÈò™",name_en:"Osaka",name_zh:"Â§ßÈò™",name_ko:"Ïò§ÏÇ¨Ïπ¥",region_ja:"Â§ßÈò™Â∫ú",region_en:"Osaka",region_zh:"Â§ßÈò™Â∫ú",region_ko:"Ïò§ÏÇ¨Ïπ¥Î∂Ä"},{id:"fukuoka",lat:33.5904,lon:130.4017,name_ja:"Á¶èÂ≤°",name_en:"Fukuoka",name_zh:"Á¶èÂÜà",name_ko:"ÌõÑÏø†Ïò§Ïπ¥",region_ja:"Á¶èÂ≤°Áúå",region_en:"Fukuoka",region_zh:"Á¶èÂÜàÂéø",region_ko:"ÌõÑÏø†Ïò§Ïπ¥ÌòÑ"}],nagano:[{id:"hokushin",lat:36.6485,lon:138.1948,name_ja:"Èï∑ÈáéÂ∏Ç",name_en:"Nagano",name_zh:"ÈïøÈáéÂ∏Ç",name_ko:"ÎÇòÍ∞ÄÎÖ∏Ïãú",region_ja:"Âåó‰ø°",region_en:"North Shin",region_zh:"Âåó‰ø°",region_ko:"Î∂ÅÏã†"},{id:"toushin",lat:36.402,lon:138.249,name_ja:"‰∏äÁî∞Â∏Ç",name_en:"Ueda",name_zh:"‰∏äÁî∞Â∏Ç",name_ko:"Ïö∞ÏóêÎã§Ïãú",region_ja:"Êù±‰ø°",region_en:"East Shin",region_zh:"‰∏ú‰ø°",region_ko:"ÎèôÏã†"},{id:"chushin",lat:36.238,lon:137.9724,name_ja:"ÊùæÊú¨Â∏Ç",name_en:"Matsumoto",name_zh:"ÊùæÊú¨Â∏Ç",name_ko:"ÎßàÏì∞Î™®ÌÜ†Ïãú",region_ja:"‰∏≠‰ø°",region_en:"Central Shin",region_zh:"‰∏≠‰ø°",region_ko:"Ï§ëÏã†"},{id:"nanshin",lat:35.5151,lon:137.8217,name_ja:"È£ØÁî∞Â∏Ç",name_en:"Iida",name_zh:"È•≠Áî∞Â∏Ç",name_ko:"Ïù¥Îã§Ïãú",region_ja:"Âçó‰ø°",region_en:"South Shin",region_zh:"Âçó‰ø°",region_ko:"ÎÇ®Ïã†"},{id:"suwa",lat:36.0392,lon:138.1131,name_ja:"Ë´èË®™Â∏Ç",name_en:"Suwa",name_zh:"ËØπËÆøÂ∏Ç",name_ko:"Ïä§ÏôÄÏãú",region_ja:"Ë´èË®™„Ç®„É™„Ç¢",region_en:"Suwa Area",region_zh:"ËØπËÆøÂå∫Âüü",region_ko:"Ïä§ÏôÄ ÏßÄÏó≠"},{id:"inaji",lat:35.8274,lon:137.9537,name_ja:"‰ºäÈÇ£Â∏Ç",name_en:"Ina",name_zh:"‰ºäÈÇ£Â∏Ç",name_ko:"Ïù¥ÎÇòÏãú",region_ja:"‰ºäÈÇ£Ë∑Ø„Ç®„É™„Ç¢",region_en:"Inaji Area",region_zh:"‰ºäÈÇ£Ë∑ØÂå∫Âüü",region_ko:"Ïù¥ÎÇòÏßÄ ÏßÄÏó≠"},{id:"kisoj",lat:35.8423,lon:137.6937,name_ja:"Êú®ÊõΩÁî∫",name_en:"Kiso",name_zh:"Êú®ÊõæÁî∫",name_ko:"Í∏∞ÏÜåÎßàÏπò",region_ja:"Êú®ÊõΩË∑Ø„Ç®„É™„Ç¢",region_en:"Kisoji Area",region_zh:"Êú®ÊõæË∑ØÂå∫Âüü",region_ko:"Í∏∞ÏÜåÏßÄ ÏßÄÏó≠"},{id:"alps",lat:36.5045,lon:137.8518,name_ja:"Â§ßÁî∫Â∏Ç",name_en:"Omachi",name_zh:"Â§ßÁî∫Â∏Ç",name_ko:"Ïò§ÎßàÏπòÏãú",region_ja:"Êó•Êú¨„Ç¢„É´„Éó„Çπ„Ç®„É™„Ç¢",region_en:"Japan Alps Area",region_zh:"Êó•Êú¨ÈòøÂ∞îÂçëÊñØÂå∫Âüü",region_ko:"ÏùºÎ≥∏ ÏïåÌîÑÏä§ ÏßÄÏó≠"}],warning_areas:[{code:"016000",label_ja:"Êú≠Âπå(ÂåóÊµ∑ÈÅì)",label_en:"Sapporo (Hokkaido)",label_zh:"Êú≠ÂπåÔºàÂåóÊµ∑ÈÅìÔºâ"},{code:"040000",label_ja:"‰ªôÂè∞(ÂÆÆÂüéÁúå)",label_en:"Sendai (Miyagi)",label_zh:"‰ªôÂè∞ÔºàÂÆ´ÂüéÂéøÔºâ"},{code:"130000",label_ja:"Êù±‰∫¨(Êù±‰∫¨ÈÉΩ)",label_en:"Tokyo (Tokyo)",label_zh:"‰∏ú‰∫¨Ôºà‰∏ú‰∫¨ÈÉΩÔºâ"},{code:"230000",label_ja:"ÂêçÂè§Â±ã(ÊÑõÁü•Áúå)",label_en:"Nagoya (Aichi)",label_zh:"ÂêçÂè§Â±ãÔºàÁà±Áü•ÂéøÔºâ"},{code:"270000",label_ja:"Â§ßÈò™(Â§ßÈò™Â∫ú)",label_en:"Osaka (Osaka)",label_zh:"Â§ßÈò™ÔºàÂ§ßÈò™Â∫úÔºâ"},{code:"400000",label_ja:"Á¶èÂ≤°(Á¶èÂ≤°Áúå)",label_en:"Fukuoka (Fukuoka)",label_zh:"Á¶èÂÜàÔºàÁ¶èÂÜàÂéøÔºâ"},{code:"200000",label_ja:"Èï∑ÈáéÁúå",label_en:"Nagano",label_zh:"ÈïøÈáéÂéø"}],wmo:[{code:0,icon:"‚òÄÔ∏è",ja:"Âø´Êô¥",en:"Clear",ko:"ÎßëÏùå"},{code:1,icon:"üå§Ô∏è",ja:"Êô¥„Çå",en:"Mostly clear",ko:"ÎåÄÏ≤¥Î°ú ÎßëÏùå"},{code:2,icon:"‚õÖ",ja:"Êô¥„Çå„ÅÆ„Å°Êõá„Çä",en:"Partly cloudy",ko:"Î∂ÄÎ∂ÑÏ†ÅÏúºÎ°ú ÌùêÎ¶º"},{code:3,icon:"‚òÅÔ∏è",ja:"Êõá„Çä",en:"Cloudy",ko:"ÌùêÎ¶º"},{code:45,icon:"üå´Ô∏è",ja:"Èúß",en:"Fog",ko:"ÏïàÍ∞ú"},{code:48,icon:"üå´Ô∏è",ja:"Èúß(ÁùÄÊ∞∑)",en:"Rime fog",ko:"Ï∞©Îπô ÏïàÍ∞ú"},{code:51,icon:"üå¶Ô∏è",ja:"ÈúßÈõ®(Âº±)",en:"Light drizzle",ko:"ÏïΩÌïú Ïù¥Ïä¨ÎπÑ"},{code:53,icon:"üå¶Ô∏è",ja:"ÈúßÈõ®",en:"Drizzle",ko:"Ïù¥Ïä¨ÎπÑ"},{code:55,icon:"üå¶Ô∏è",ja:"ÈúßÈõ®(Âº∑)",en:"Dense drizzle",ko:"Í∞ïÌïú Ïù¥Ïä¨ÎπÑ"},{code:61,icon:"üåßÔ∏è",ja:"Èõ®(Âº±)",en:"Light rain",ko:"ÏïΩÌïú ÎπÑ"},{code:63,icon:"üåßÔ∏è",ja:"Èõ®",en:"Rain",ko:"ÎπÑ"},{code:65,icon:"üåßÔ∏è",ja:"Èõ®(Âº∑)",en:"Heavy rain",ko:"Í∞ïÌïú ÎπÑ"},{code:71,icon:"üå®Ô∏è",ja:"Èõ™(Âº±)",en:"Light snow",ko:"ÏïΩÌïú Îàà"},{code:73,icon:"‚ùÑÔ∏è",ja:"Èõ™",en:"Snow",ko:"Îàà"},{code:75,icon:"‚ùÑÔ∏è",ja:"Èõ™(Âº∑)",en:"Heavy snow",ko:"Í∞ïÌïú Îàà"},{code:77,icon:"üå®Ô∏è",ja:"„ÅÇ„Çâ„Çå",en:"Snow grains",ko:"Ïã∏ÎùΩÎàà"},{code:80,icon:"üå¶Ô∏è",ja:"„Å´„Çè„ÅãÈõ®(Âº±)",en:"Light showers",ko:"ÏïΩÌïú ÏÜåÎÇòÍ∏∞"},{code:81,icon:"üå¶Ô∏è",ja:"„Å´„Çè„ÅãÈõ®",en:"Showers",ko:"ÏÜåÎÇòÍ∏∞"},{code:82,icon:"‚õàÔ∏è",ja:"„Å´„Çè„ÅãÈõ®(Âº∑)",en:"Heavy showers",ko:"Í∞ïÌïú ÏÜåÎÇòÍ∏∞"},{code:85,icon:"üå®Ô∏è",ja:"„Å´„Çè„ÅãÈõ™",en:"Snow showers",ko:"Îàà ÏÜåÎÇòÍ∏∞"},{code:86,icon:"üå®Ô∏è",ja:"„Å´„Çè„ÅãÈõ™(Âº∑)",en:"Heavy snow showers",ko:"Í∞ïÌïú Îàà ÏÜåÎÇòÍ∏∞"},{code:95,icon:"‚õàÔ∏è",ja:"Èõ∑Èõ®",en:"Thunderstorm",ko:"ÎáåÏö∞"},{code:96,icon:"‚õàÔ∏è",ja:"Èõ∑Èõ®+„Å≤„Çá„ÅÜ",en:"Storm + hail",ko:"ÎáåÏö∞+Ïö∞Î∞ï"},{code:99,icon:"‚õàÔ∏è",ja:"ÊøÄ„Åó„ÅÑÈõ∑Èõ®",en:"Severe storm",ko:"Í∞ïÌïú ÎáåÏö∞"}]};var d=Y,l=d.cities,U=d.nagano,$=d.warning_areas,h=d.ui,x=new Map(d.wmo.map((i)=>[i.code,i])),_="ja";function P(i){return x.get(i)??{code:i,icon:"‚ùì",ja:`(${i})`,en:`(${i})`,ko:`(${i})`}}function w(i){let n=_==="en"?i.name_en||i.name_ja:_==="zh"?i.name_zh||i.name_en||i.name_ja:_==="ko"?i.name_ko||i.name_en||i.name_ja:i.name_ja,o=_==="en"?i.region_en||i.region_ja:_==="zh"?i.region_zh||i.region_en||i.region_ja:_==="ko"?i.region_ko||i.region_en||i.region_ja:i.region_ja;return{name:n,region:o}}function f(){let i=h[_],n=document.getElementById("board-title");if(n)n.textContent=i.boardTitle;let o=document.getElementById("warning-title");if(o)o.textContent=i.warningTitle;let e=document.getElementById("pi-title");if(e)e.textContent=i.piTitle;let m=document.getElementById("major-label");if(m)m.textContent=i.majorLabel;let a=document.getElementById("nagano-label");if(a)a.textContent=i.naganoLabel;r(new Date)}function D(i){return i.label_ja}function N(i,n){let o=document.createElement("div");o.className="weather-card",o.id=`card-${i.id}`;let e=w(i);return o.innerHTML=`
    <div style="display:flex;justify-content:space-between;align-items:flex-start">
      <div>
        <div class="card-city">${e.name}</div>
        <div class="card-region">${e.region}</div>
      </div>
      <div class="loading">‚Ä¶</div>
    </div>
  `,o}var v=4,J=1800000,W=Date.now()+J,s=0,b={};function K(i){let n=document.getElementById("nagano-grid");if(!n)return;let o=Math.ceil(U.length/v);s=(i%o+o)%o;let e=s*v,m=U.slice(e,e+v);n.innerHTML="",m.forEach((j)=>{if(n.appendChild(N(j,!0)),b[j.id])V(j,b[j.id])});let a=document.getElementById("nagano-page-indicator");if(a)a.textContent=`(${s+1}/${o})`}function A(){let i=document.getElementById("cities-grid");l.forEach((n)=>i.appendChild(N(n,!1))),K(0)}async function u(i){let n=`https://api.open-meteo.com/v1/forecast?latitude=${i.lat}&longitude=${i.lon}&current=temperature_2m,weather_code,wind_speed_10m,relative_humidity_2m&daily=weather_code,temperature_2m_max,temperature_2m_min,precipitation_probability_max&hourly=temperature_2m&past_hours=2&forecast_hours=1&timezone=Asia%2FTokyo&forecast_days=1`,o=await fetch(n);if(!o.ok)throw Error(o.status.toString());return o.json()}function B(i,n){let o=document.getElementById(i);if(!o)return;let e=(n||"").trim()||h[_].noInfo;o.textContent=`${e}„ÄÄ‚óÜ„ÄÄ${e}„ÄÄ‚óÜ„ÄÄ`;let m=Math.max(24,Math.min(90,Math.round(e.length*0.45)));o.style.animationDuration=`${m}s`}function C(){let i=l.map((n)=>{let o=b[n.id];if(!o||!o.current||!o.daily)return`${n.name_ja}: --`;let e=P(o.current.weather_code),m=_==="en"?e.en:_==="zh"?e.zh||e.en:_==="ko"?e.ko||e.en:e.ja,a=Math.round(o.current.temperature_2m),j=o.daily.precipitation_probability_max?.[0]??"--",k=h[_];return`${w(n).name} ${a}¬∞C ${m} ${k.precip}${j}%`});B("city-track",i.join(" ÔΩú "))}async function q(){try{let n=(await Promise.allSettled($.map(async(o)=>{let e=await fetch(`https://www.jma.go.jp/bosai/warning/data/warning/${o.code}.json`);if(!e.ok)throw Error(String(e.status));let m=await e.json(),a=(m.headlineText||"").trim(),j=(m.reportDatetime||"").replace("T"," ").replace("+09:00",""),k=D(o);if(!a)return`${k}: ${h.ja.warningNoHeadline}`;return`${k} [${j}] ${a}`}))).map((o,e)=>{if(o.status==="fulfilled")return o.value;return`${D($[e])}: ${h.ja.warningFetchFailed}`});B("alert-track",n.join(" ÔΩú "))}catch(i){B("alert-track",h.ja.warningAllFailed)}}async function Q(){try{let i=await fetch("/api/pi-status");if(!i.ok)throw Error("status");let n=await i.json(),o=n.mem?`${n.mem.used_gb}/${n.mem.total_gb}GB (${n.mem.used_pct}%)`:"--",e=n.disk?`${n.disk.used_gb}/${n.disk.total_gb}GB (${n.disk.used_pct}%)`:"--",m=n.cpu_temp_c??"--",a=n.load1??"--",j=n.uptime||"--",k=n.ip||"--",z=h[_];document.getElementById("pi-status").innerHTML=`
      <span>${z.piTemp}: <b>${m}¬∞C</b></span>
      <span>${z.piLoad}: <b>${a}</b></span>
      <span>${z.piMem}: <b>${o}</b></span>
      <span>${z.piDisk}: <b>${e}</b></span>
      <span>${z.piUptime}: <b>${j}</b></span>
      <span>${z.piIp}: <b>${k}</b></span>
    `}catch(i){document.getElementById("pi-status").innerHTML=`<span>${h[_].failed}</span>`}}function L(i){if(i>=1.5)return{symbol:"‚Üë",cls:"up-fast"};if(i>=0.5)return{symbol:"‚Üó",cls:"up"};if(i<=-1.5)return{symbol:"‚Üì",cls:"down-fast"};if(i<=-0.5)return{symbol:"‚Üò",cls:"down"};return{symbol:"‚Üí",cls:"flat"}}function T(i){let n=Number(i?.current?.temperature_2m),o=i?.hourly?.time||[],e=i?.hourly?.temperature_2m||[];if(!Number.isFinite(n)||!Array.isArray(o)||!Array.isArray(e)||o.length===0)return 0;let m=Date.now()-1800000,a=-1,j=1/0;for(let k=0;k<o.length;k++){let z=new Date(o[k]).getTime();if(!Number.isFinite(z))continue;let p=Math.abs(z-m);if(p<j)j=p,a=k}if(a<0||!Number.isFinite(Number(e[a])))return 0;return n-Number(e[a])}function V(i,n){let o=document.getElementById(`card-${i.id}`);if(!o)return;let{current:e,daily:m}=n,a=P(e.weather_code),j=_==="en"?a.en:_==="zh"?a.zh||a.en:_==="ko"?a.ko||a.en:a.ja,k=Math.round(m.temperature_2m_max[0]),z=Math.round(m.temperature_2m_min[0]),p=m.precipitation_probability_max[0]??"--",y=w(i),g=h[_],F=L(T(n));o.innerHTML=`
    <div style="display:flex;justify-content:space-between;align-items:flex-start">
      <div>
        <div class="card-city">${y.name}</div>
        <div class="card-region">${y.region}</div>
      </div>
      <div class="card-precip">${g.precip}:${p}%</div>
    </div>
    <div class="card-weather-row">
      <span class="card-icon">${a.icon}</span>
      <div>
        <div>
          <span class="card-temp">${Math.round(e.temperature_2m)}</span>
          <span class="card-temp-unit">¬∞C</span>
          <span class="card-trend ${F.cls}">${F.symbol}</span>
        </div>
        <div class="card-desc">${j}</div>
      </div>
    </div>
    <div class="card-minmax">
      <span class="max">‚Üë${k}¬∞</span>
      &nbsp;
      <span class="min">‚Üì${z}¬∞</span>
    </div>
    <div class="card-details">
      <span class="card-detail">\uD83D\uDCA8 ${g.wind} ${Math.round(e.wind_speed_10m)}km/h</span>
      <span class="card-detail">\uD83D\uDCA7 ${g.humidity} ${e.relative_humidity_2m}%</span>
    </div>
  `,o.classList.add("loaded")}function I(i,n){let o=document.getElementById(`card-${i.id}`);if(!o)return;let e=w(i);o.innerHTML=`
    <div class="card-city">${e.name}</div>
    <div class="card-region">${e.region}</div>
    <div class="error">${h[_].failed}</div>
  `}async function R(){document.getElementById("last-updated").textContent=`${h[_].updating}`;let i=[...l,...U];await Promise.allSettled(i.map(async(o)=>{try{let e=await u(o);b[o.id]=e,V(o,e)}catch(e){I(o,e.message)}})),C();let n=new Date;W=n.getTime()+J,document.getElementById("last-updated").textContent=`${h[_].updated}: ${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`}function r(i){let n=Math.max(0,W-i.getTime()),o=String(Math.floor(n/60000)).padStart(2,"0"),e=String(Math.floor(n%60000/1000)).padStart(2,"0"),m=document.getElementById("next-update");if(m)m.textContent=`${h[_].nextUpdate} ${o}:${e}`}function E(i,n){try{if(n==="gregory")return`${i.getFullYear()}/${String(i.getMonth()+1).padStart(2,"0")}/${String(i.getDate()).padStart(2,"0")}`;if(n==="japanese")return new Intl.DateTimeFormat("ja-JP-u-ca-japanese",{year:"numeric",month:"2-digit",day:"2-digit"}).format(i);return new Intl.DateTimeFormat("zh-CN-u-ca-chinese",{year:"numeric",month:"long",day:"numeric"}).format(i)}catch{return`${i.getFullYear()}/${String(i.getMonth()+1).padStart(2,"0")}/${String(i.getDate()).padStart(2,"0")}`}}function t(i){let n=Math.floor(i.getTime()/6000);if(_==="zh")return["gregory","japanese","chinese"][n%3];return["gregory","japanese"][n%2]}function G(){let i=new Date,n=i.getHours(),o=n.toString().padStart(2,"0"),e=i.getMinutes().toString().padStart(2,"0"),m=i.getSeconds().toString().padStart(2,"0");document.getElementById("clock").textContent=`${o}:${e}:${m}`;let a=(n+11)%12+1,j=n<12,k=h[_],z=j?k.am:k.pm,p=_==="en"?`${z} ${a}:00`:`${z}${a}${k.hourUnit}`,y=document.getElementById("clock12-str");if(y)y.textContent=p;let g=document.getElementById("weekday-str");if(g)g.textContent=k.weekdays[i.getDay()];let F=t(i),M=document.getElementById("date-str");if(M)M.textContent=E(i,F),M.classList.toggle("is-chinese-cal",F==="chinese");r(i)}var S;function c(){document.body.classList.remove("cursor-hidden"),clearTimeout(S),S=setTimeout(()=>{document.body.classList.add("cursor-hidden")},3000)}["mousemove","mousedown","wheel","touchstart","keydown"].forEach((i)=>{window.addEventListener(i,c,{passive:!0})});var O=["ja","en","zh","ko"],H=0;function ii(i){if(i===_)return;_=i,f(),l.forEach((o)=>{if(b[o.id])V(o,b[o.id])}),K(s),q(),Q();let n=new Date;document.getElementById("last-updated").textContent=`${h[_].updated}: ${n.getHours().toString().padStart(2,"0")}:${n.getMinutes().toString().padStart(2,"0")}`}function ni(){H=(H+1)%O.length,ii(O[H])}f();A();G();setInterval(G,1000);R();q();Q();document.body.classList.add("cursor-hidden");setInterval(R,J);setInterval(q,600000);setInterval(Q,60000);var Z=0;setInterval(()=>{if(K(s+1),Z++,Z%2===0)ni()},12000);
